{"version":3,"sources":["./src/app/modules/video-conference/video-conference-routing.module.ts","./src/app/modules/video-conference/video-conference.component.ts","./src/app/modules/video-conference/video-conference.component.html","./src/app/modules/video-conference/video-conference.module.ts"],"names":[],"mappings":"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","file":"modules-video-conference-video-conference-module-es2015.js","sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { Routes, RouterModule } from '@angular/router';\r\nimport { VideoConferenceComponent } from './video-conference.component';\r\n\r\n\r\nconst routes: Routes = [\r\n  { path: '', component: VideoConferenceComponent },\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule]\r\n})\r\nexport class VideoConferenceRoutingModule { }\r\n","import { CookieService } from 'ngx-cookie-service';\r\nimport { Component, OnInit, Inject } from '@angular/core';\r\nimport { ConsultationService } from 'src/app/services/consultation.service';\r\nimport { UserService } from 'src/app/services/user.service';\r\nimport { MessageService } from 'primeng/api';\r\nimport { Router } from '@angular/router';\r\nvar OT = window['OT'];\r\nimport { DOCUMENT } from '@angular/common';\r\n@Component({\r\n  selector: 'app-video-conference',\r\n  templateUrl: './video-conference.component.html',\r\n  styleUrls: ['./video-conference.component.scss']\r\n})\r\nexport class VideoConferenceComponent implements OnInit {\r\n\r\n  apiKey = \"46730612\";\r\n  // sessionId = \"2_MX40NjczMDYxMn5-MTU5MDQxNzMyMjA5Nn56OEhQTGxyMTQ2N2JZbk1ZdTVlcDZtYkp-UH4\";\r\n  // token = \"T1==cGFydG5lcl9pZD00NjczMDYxMiZzaWc9NjZkYmRjMzc0NGRjYWU5MjQ2NzkyMGMwN2JiNjFlYWI2MWE2NDA0MzpzZXNzaW9uX2lkPTJfTVg0ME5qY3pNRFl4TW41LU1UVTVNRFF4TnpNeU1qQTVObjU2T0VoUVRHeHlNVFEyTjJKWmJrMVpkVFZsY0RadFlrcC1VSDQmY3JlYXRlX3RpbWU9MTU5MDQxODE5NCZub25jZT0wLjk3MjI3NDIwMzk5MzA1MTQmcm9sZT1wdWJsaXNoZXImZXhwaXJlX3RpbWU9MTU5MDUwNDU5NCZpbml0aWFsX2xheW91dF9jbGFzc19saXN0PQ==\";\r\n  sessionId: any;\r\n  session: any;\r\n  token: any;\r\n  timer: any;\r\n  countDown: any;\r\n  min: any;\r\n  remSec: any;\r\n  sec: any;\r\n  constructor(@Inject(DOCUMENT) private document: Document,\r\n  public confernceService: ConsultationService,\r\n    public messageService: MessageService,\r\n    public router: Router,\r\n    public userService: UserService,\r\n    public CookieService:CookieService) {\r\n    this.getSession();\r\n  }\r\n\r\n  getSession() {\r\n    if (this.userService.getUserDesignation() === 'Doctor') {\r\n      this.confernceService.getDoctorSession().then(resData => {\r\n        if (resData.code === 200) {\r\n          this.sessionId = resData.data.sessionId;\r\n          this.token = resData.data.token;\r\n          this.initializeSession();\r\n        } else {\r\n          this.showToast('error', \"Session Faild\", resData.data);\r\n          this.router.navigate(['/']);\r\n        }\r\n      }).catch(error => {\r\n        console.log(\"VideoConferenceComponent -> getSession -> error\", error)\r\n      })\r\n    } else if (this.userService.getUserDesignation() === 'User') {\r\n      this.confernceService.getPatientSession().then(resData => {\r\n        if (resData.code === 200) {\r\n          this.sessionId = resData.data.sessionId;\r\n          this.token = resData.data.token;\r\n          this.initializeSession();\r\n        } else {\r\n          this.showToast('error', \"Session Faild\", resData.data)\r\n          this.router.navigate(['/']);\r\n        }\r\n      }).catch(error => {\r\n        console.log(\"VideoConferenceComponent -> getSession -> error\", error)\r\n      })\r\n    }\r\n  }\r\n\r\n  initializeSession() {\r\n    this.getSessionChecked();\r\n    var session = OT.initSession(this.apiKey, this.sessionId);\r\n    console.log(\"VideoConferenceComponent -> initializeSession -> this.apiKey\", this.apiKey, this.sessionId, this.token)\r\n    session.on('streamCreated', function (event) {\r\n      session.subscribe(event.stream, 'subscriber', {\r\n        insertMode: 'append',\r\n        width: '100%',\r\n        height: '100%'\r\n      }, this.handleError);\r\n    });\r\n\r\n    var publisher = OT.initPublisher('publisher', {\r\n      insertMode: 'append',\r\n      width: '100%',\r\n      height: '100%'\r\n    }, this.handleError);\r\n\r\n    session.connect(this.token, function (error) {\r\n      if (error) {\r\n        if (error.code == 1004) {\r\n          this.initializeSession();\r\n          return;\r\n        }\r\n        this.handleError(error);\r\n      } else {\r\n        session.publish(publisher);\r\n      }\r\n    });\r\n  }\r\n\r\n  handleError(error) {\r\n    if (error) {\r\n      alert(error.message);\r\n    }\r\n  }\r\n\r\n  getSessionChecked() {\r\n    var timeInterval = setInterval(() => {\r\n      if (this.userService.getUserDesignation() === 'Doctor') {\r\n        this.confernceService.getDoctorSession().then(resData => {\r\n          if (resData.code === 201) {\r\n            clearInterval(timeInterval);\r\n            this.router.navigate(['/']);\r\n          }\r\n        }).catch(error => {\r\n          console.log(\"VideoConferenceComponent -> getSession -> error\", error)\r\n        })\r\n      } else if (this.userService.getUserDesignation() === 'User') {\r\n        this.confernceService.getPatientSession().then(resData => {\r\n          if (resData.code === 201) {\r\n            clearInterval(timeInterval);\r\n            this.router.navigate(['/']);\r\n          }\r\n        }).catch(error => {\r\n          console.log(\"VideoConferenceComponent -> getSession -> error\", error)\r\n        })\r\n      }\r\n    }, 3000);\r\n  }\r\n\r\n  endSession() {\r\n\r\n    const Cooki=JSON.parse(this.CookieService.get('userInfo_WhealthyLife'))\r\nconst data={\r\n  patient:Cooki._id\r\n}\r\n    this.confernceService.endSession(data).then(resData => {\r\n      console.log(\"VideoConferenceComponent -> endSession -> resData\", resData);\r\n      this.document.location.href = 'http://localhost:4200/';\r\n    }).catch(error => {\r\n      console.log(\"VideoConferenceComponent -> endSession -> error\", error)\r\n    })\r\n  }\r\n\r\n  ngOnInit(): void {\r\n    this.timerCounter();\r\n  }\r\n\r\n  ngAfterViewInit() {\r\n  }\r\n\r\n  timerCounter() {\r\n    this.sec = 1800;\r\n    this.countDown = setInterval(() => {\r\n      this.secpass();\r\n    }, 1000);\r\n  }\r\n\r\n  showToast(type, messageType, message) {\r\n    setTimeout(() => {\r\n      this.messageService.add({ severity: type, summary: messageType, detail: message });\r\n    });\r\n  }\r\n\r\n\r\n  secpass() {\r\n    this.min = Math.floor(this.sec / 60);\r\n    this.remSec = this.sec % 60;\r\n    if (this.remSec < 10) {\r\n      this.remSec = '0' + this.remSec;\r\n    }\r\n    if (this.min < 10) {\r\n      this.min = '0' + this.min;\r\n    }\r\n    if (this.sec > 0) {\r\n      this.sec = this.sec - 1;\r\n    } else {\r\n      clearInterval(this.countDown);\r\n    }\r\n  }\r\n}\r\n","<p-toast class=\"custom-error\" [showTransformOptions]=\"'translateX(100%)'\"></p-toast>\r\n<div id=\"videos\">\r\n    <div id=\"subscriber\"></div>\r\n    <div id=\"publisher\"></div>\r\n    <div id=\"endcall\"><button mat-flat-button color=\"warn\" (click)=\"endSession()\">End call</button></div>\r\n    <div id=\"timer\">{{min}} : {{remSec}}</div>\r\n    <div id=\"addPrescription\"> <button mat-raised-button>\r\n            <mat-icon>dynamic_feed</mat-icon>add prescription\r\n        </button></div>\r\n    <div id=\"addMedicine\"> <button mat-raised-button>\r\n            <mat-icon>note_add</mat-icon>add medicine\r\n        </button></div>\r\n    <div id=\"addMedia\">\r\n        <button mat-raised-button>\r\n            <mat-icon>perm_media</mat-icon> add media\r\n        </button>\r\n    </div>\r\n</div>","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\n\r\nimport { VideoConferenceRoutingModule } from './video-conference-routing.module';\r\nimport { VideoConferenceComponent } from './video-conference.component';\r\nimport { SharedModule } from 'src/app/shared/shared.module';\r\n\r\n@NgModule({\r\n  declarations: [\r\n    VideoConferenceComponent\r\n  ],\r\n  imports: [\r\n    CommonModule,\r\n    VideoConferenceRoutingModule,\r\n    SharedModule\r\n  ]\r\n})\r\nexport class VideoConferenceModule { }\r\n"],"sourceRoot":"webpack:///"}